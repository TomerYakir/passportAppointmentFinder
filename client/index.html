<!DOCTYPE html>
<html lang="en" dir="rtl">
    <head>
        <title>Passport appointment finder</title>
        <meta charset="utf-8">
        <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.rtl.min.css" rel="stylesheet">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
        <script src="./index.js"></script>
    </head>
    <body>
        <div class="container">
            <h1>חיפוש תור אוטומטי לחידוש/הוצאת דרכון</h1>
            <div>
                <span id="location">מזהה מיקום נוכחי...</span>
                <input type="hidden" id="lat" />
                <input type="hidden" id="lng" />
            </div>
            <div>
                <h3>הוראות שימוש</h3>
                <ol>
                    <li>כנס ל<a href="http://myvisit.com/#!/home/provider/56">אתר זימון התורים</a></li>
                    <li>הזן מספר טלפון</li>
                    <li>הזן את הקוד שנשלח לנייד</li>
                    <li>דרך ה-network tab ב-developer console של chrome, חפש בקשה ל-LocationSearch</li>
                    <li>העתק את הערך של הauthorization מתוך Request Headers</li>
                </ol>
            </div>
            <div>
                <label for="jwt">קוד הזדהות</label>
                <input class="form-control input-lg" type="text" id="jwt"></input>
                <button id="run" class="btn btn-primary disabled" onClick="findAppointments()">חפש!</button>
            </div>
            <div class="alert alert-info" id="status">

            </div>
            <table class="table table-striped table-condensed">
                <thead>
                    <th style="width: 16.66%" >מיקום</th>
                    <th style="width: 16.66%" >תאריך</th>
                    <th style="width: 66.66%">שעות</th>
                </thead>
                <tbody id="slots">

                </tbody>
            </table>
          </div>
        <script>
            getCurrentLocation().then((res) => {
                $("#lat").val(res.lat);
                $("#lng").val(res.lng);
                $("#location").text(`אתה נמצא ב${res.city}. קורדינטות ${res.lat}, ${res.lng}`);
                $("#run").removeClass("disabled");
            });
            addSlotsToTable();
        </script>
    </body>
</html>
